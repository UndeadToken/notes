fwbuilder
(use ipf for FreeBSD or pf for OpenBSD)
use logcheck to log unusual files in logs. within /etc/logcheck/logcheck.logfiles, default values work fine if the .etc/rsyslog.conf gile has not been completely overhauled.

What are you trying to protect?
what are you trying to protect against?
Who are you trying to protect against?

Firewall / packet filtering. fail2ban (apt install fail2ban)
disable services you do not user

linux kernel embeds netfilter firewall which can be controlled with iptables and ip6tables, fwbuilder.

logging: systemd or ulogd

ICMP - Internet Control Message protocol
http://www.faqs.org/rfcs/rfc777.html
http://www.faqs.org/rfcs/rfc792.html
Note: ICMPv6 is required for an IPv6 network.

IP Tables:
List rules(incoming packets) - iptables -n -L INPUT

-N create new chain
-X delete empty chain e.g. iptables -X ddos-attack
-A Add rule to chain
-I Insert rule before the given rule number
-D delete a rule, 
-L --line-numbers - list rules with numbers
-F flush chain - clear all rules in given table or chain.
-P Define chain policy - e.g. drop incoming traffic, iptables -P INPUT DROP

Rules:
ACCEPT - allow the packet to go on its way
REJECT - reject the message with ICMP(Internet Control Message Protocol)
DROP - delete / ignore the packet
LOG - (via syslogd) a message wit ha description of the packet.(This does not interrupt processing.) To reject also apply LOG and REJECT/DROP.
	common parameters include: --log-level, --log-prefix, --log-tcp-sequence, --log-ip-options.

REDIRECT - with --to-ports option.

You can also pass in a chain name which will jumpt to that chain.

Accept traffic for ssh.
iptables -A INPUT -m state --state NEW -p tcp --dport 22 -j ACCEPT

Delete rule.
iptables -n -L INPUT --line-numbers(list rules with line numbers)
iptables -D INPUT 1

Implement firewall rules each time the machine is booted:
Add to network interface configuration in /etc/network/interfaces/ file.
e.g.

autho eth0
    address 192.168.0.1
    network 192.168.0.0
    netmask 255.255.255.0
    broadcast 192.168.0.255
    up /usr/local/etc/firewallthingy.fw

logcheck

cracking attempts - /etc/logcheck/cracking.d/
ignored cracking attempts - -/etc/logcheck/cracking.ignore.d/
security alert - /etc/logcheck/violations.d/
ignored security alert - /etc/logcheck/violations.ignore.d/
remainging messages are system events.

Detecting changes.
dpkg --verify or dpkg -V - displays system files that have been modified.
It uses checksums stored within /var/lib/dpkg/info/package.md5sums database though an attacker may modify these to contain the new checksums.

Advanced Intrusion Detection Environment (AIDE)
checks file integrity and detects changes against a previously-recorded image of the valid system. 
The image is stored as a database /var/lib/aide/aide.db inclusive of pringer-prints, permissions, timestamps etc...

apt install aide
init db with: aideinit which will run daily via the /etc/cron.daily/aide script
logs to: /var/log/aide/*.log
The database can be compromised so store the reference data on read only media.

Use .etc/default/aide to tweak the behaviour of the aide package.

/etc/aide/aide.conf and /etc/aide/aide.conf.d used by update-aide.conf to generate /var/lib/aide/aide.conf.autogenerated

A new version of the database is generated daily. /var/lib/aide/aide.db.new

tripwire is similar to aide except you can sign the configuration file so that an attacker cannot make it point at a different version of the reference database.

see also Samhain chkrootkit, checksecurity and rkhunter packages for detecting rootkits.

