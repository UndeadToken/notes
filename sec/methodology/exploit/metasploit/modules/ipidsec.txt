TCP idle scan.

Allows us to scan a target stealthily by spoofing the ip address of another host on the network. For this type of scan to work we first need to locate an idle host on the network that uses incremental IP IDs (which are used to track packet order). When we discover an idle system that uses incremental IP IDs, the IP IDs become predictable and we can then predict the next ID. However, when spoofing the address of an idle host while scanning a targets responses from open ports, we can see a break in the predictability of the IP ID sequence, which indicates that we have discovered an open port.

Attempt to find idle host:

use auxiliary/scanner/ip/ipidsec
set RHOSTS <target>
set THREADS 50 (windows max 16, UNIX max 128)
run

Select and scan idle host:
nmap -PN -sI <zombie> <target>

Store results in db.
db_nmap -sS -A <target>
serviceswh

search portscan
use auxiliary/scanner/portscan/syn
set RHOSTS <host>
set THREADS 5
run
